var Validator=Class.create();Validator.prototype={initialize:function(_1,_2,_3,_4){if(typeof _3=="function"){this.options=$H(_4);this._test=_3;}else{this.options=$H(_3);this._test=function(){return true;};}this.error=_2||"Validation failed.";this.className=_1;},test:function(v,_6){return (this._test(v,_6)&&this.options.all(function(p){return Validator.methods[p.key]?Validator.methods[p.key](v,_6,p.value):true;}));}};Validator.methods={pattern:function(v,_9,_a){return Validation.get("IsEmpty").test(v)||_a.test(v);},minLength:function(v,_c,_d){return v.length>=_d;},maxLength:function(v,_f,opt){return v.length<=opt;},min:function(v,elm,opt){return v>=parseFloat(opt);},max:function(v,elm,opt){return v<=parseFloat(opt);},notOneOf:function(v,elm,opt){return $A(opt).all(function(_1a){return v!=_1a;});},oneOf:function(v,elm,opt){return $A(opt).any(function(_1e){return v==_1e;});},is:function(v,elm,opt){return v==opt;},isNot:function(v,elm,opt){return v!=opt;},equalToField:function(v,elm,opt){return v==$F(opt);},notEqualToField:function(v,elm,opt){return v!=$F(opt);},include:function(v,elm,opt){return $A(opt).all(function(_2e){return Validation.get(_2e).test(v,elm);});}};var Validation=Class.create();Validation.prototype={initialize:function(_2f,_30){this.options=Object.extend({onSubmit:true,stopOnFirst:false,immediate:false,focusOnError:true,useTitles:false,onFormValidate:function(_31,_32){},onElementValidate:function(_33,elm){}},_30||{});this.form=$(_2f);if(this.options.onSubmit){Event.observe(this.form,"submit",this.onSubmit.bind(this),false);}if(this.options.immediate){var _35=this.options.useTitles;var _36=this.options.onElementValidate;Form.getElements(this.form).each(function(_37){Event.observe(_37,"blur",function(ev){Validation.validate(Event.element(ev),{useTitle:_35,onElementValidate:_36});});});}},onSubmit:function(ev){if(!this.validate()){Event.stop(ev);}},validate:function(){var _3a=false;var _3b=this.options.useTitles;var _3c=this.options.onElementValidate;if(this.options.stopOnFirst){_3a=Form.getElements(this.form).all(function(elm){return Validation.validate(elm,{useTitle:_3b,onElementValidate:_3c});});}else{_3a=Form.getElements(this.form).collect(function(elm){return Validation.validate(elm,{useTitle:_3b,onElementValidate:_3c});}).all();}if(!_3a&&this.options.focusOnError){Form.getElements(this.form).findAll(function(elm){return $(elm).hasClassName("validation-failed");}).first().focus();}this.options.onFormValidate(_3a,this.form);return _3a;},reset:function(){Form.getElements(this.form).each(Validation.reset);}};Object.extend(Validation,{validate:function(elm,_41){_41=Object.extend({useTitle:false,onElementValidate:function(_42,elm){}},_41||{});elm=$(elm);var cn=elm.classNames();return result=cn.all(function(_45){var _46=Validation.test(_45,elm,_41.useTitle);_41.onElementValidate(_46,elm);return _46;});},test:function(_47,elm,_49){var v=Validation.get(_47);var _4b="__advice"+_47.camelize();try{if(Validation.isVisible(elm)&&!v.test($F(elm),elm)){if(!elm[_4b]){var _4c=Validation.getAdvice(_47,elm);if(_4c==null){var _4d=_49?((elm&&elm.title)?elm.title:v.error):v.error;_4c="<div class=\"validation-advice\" id=\"advice-"+_47+"-"+Validation.getElmID(elm)+"\" style=\"display:none\">"+_4d+"</div>";switch(elm.type.toLowerCase()){case "checkbox":case "radio":var p=elm.parentNode;if(p){new Insertion.Bottom(p,_4c);}else{new Insertion.After(elm,_4c);}break;default:new Insertion.After(elm,_4c);}_4c=Validation.getAdvice(_47,elm);}if(typeof Effect=="undefined"){_4c.style.display="block";}else{new Effect.Appear(_4c,{duration:1});}}elm[_4b]=true;elm.removeClassName("validation-passed");elm.addClassName("validation-failed");return false;}else{var _4c=Validation.getAdvice(_47,elm);if(_4c!=null){_4c.hide();}elm[_4b]="";elm.removeClassName("validation-failed");elm.addClassName("validation-passed");return true;}}catch(e){throw (e);}},isVisible:function(elm){while(elm.tagName!="BODY"){if(!$(elm).visible()){return false;}elm=elm.parentNode;}return true;},getAdvice:function(_50,elm){return $("advice-"+_50+"-"+Validation.getElmID(elm))||$("advice-"+Validation.getElmID(elm));},getElmID:function(elm){return elm.id?elm.id:elm.name;},reset:function(elm){elm=$(elm);var cn=elm.classNames();cn.each(function(_55){var _56="__advice"+_55.camelize();if(elm[_56]){var _57=Validation.getAdvice(_55,elm);_57.hide();elm[_56]="";}elm.removeClassName("validation-failed");elm.removeClassName("validation-passed");});},add:function(_58,_59,_5a,_5b){var nv={};nv[_58]=new Validator(_58,_59,_5a,_5b);Object.extend(Validation.methods,nv);},addAllThese:function(_5d){var nv={};$A(_5d).each(function(_5f){nv[_5f[0]]=new Validator(_5f[0],_5f[1],_5f[2],(_5f.length>3?_5f[3]:{}));});Object.extend(Validation.methods,nv);},get:function(_60){return Validation.methods[_60]?Validation.methods[_60]:Validation.methods["_LikeNoIDIEverSaw_"];},methods:{"_LikeNoIDIEverSaw_":new Validator("_LikeNoIDIEverSaw_","",{})}});Validation.add("IsEmpty","",function(v){return ((v==null)||(v.length==0));});Validation.addAllThese([["required","This is a required field.",function(v){return !Validation.get("IsEmpty").test(v);}],["validate-number","Please enter a valid number in this field.",function(v){return Validation.get("IsEmpty").test(v)||(!isNaN(v)&&!/^\s+$/.test(v));}],["validate-digits","Please use numbers only in this field. please avoid spaces or other characters such as dots or commas.",function(v){return Validation.get("IsEmpty").test(v)||!/[^\d]/.test(v);}],["validate-alpha","Please use letters only (a-z) in this field.",function(v){return Validation.get("IsEmpty").test(v)||/^[a-zA-Z]+$/.test(v);}],["validate-alphanum","Please use only letters (a-z) or numbers (0-9) only in this field. No spaces or other characters are allowed.",function(v){return Validation.get("IsEmpty").test(v)||!/\W/.test(v);}],["validate-email","Please enter a valid email address.",function(v){return Validation.get("IsEmpty").test(v)||/^([\w\.!#\$%\-+.]+@[A-Za-z0-9\-]+(\.[A-Za-z0-9\-]+)+)$/.test(v);}]]);